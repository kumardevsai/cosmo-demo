function clsTile(e,t,n,r,i){this.name=e;this.size=t;this.png=n;this.zoom=r;this.alt=i;this.fct=null;this.createTile=function(e){var t=new google.maps.ImageMapType({getTileUrl:this.fct,tileSize:new google.maps.Size(this.size,this.size),isPng:this.png,maxZoom:this.zoom,name:this.name,alt:this.alt});e.mapTypes.set(this.name,t)};this.getBingUrl=function(e,t,n){function o(e,t){while(e.length<t){e="0"+e}return e}var r=o(String(t.x.toString(2)),n+1),i=o(String(t.y.toString(2)),n+1),s="";for(var u=0;u<i.length;u+=1){s+=i[u]+r[u]}s=parseInt("0"+s,2);return e+o(s.toString(4),n)+".jpeg?g=915&mkt=en-us&n=z"}}function clsGfMarker(e){this.id=e.getAttribute("idu");this.name=e.getAttribute("name");this.lat=e.getAttribute("lat");this.lng=e.getAttribute("lng");this.curUser=e.getAttribute("curUser");this.type=e.getAttribute("type");this.liste=e.getAttribute("liste");this.width=e.getAttribute("width");this.distance=e.getAttribute("distance");this.icon=e.getAttribute("icon");this.shadow=e.getAttribute("shadow");this.resizeh=e.getAttribute("resizeh");this.resizew=e.getAttribute("resizew");this.zoomMe=e.getAttribute("zoomMe");this.trace=e.getAttribute("trace");this.salesRad=e.getAttribute("salesRad");this.factor=1;this.point=new google.maps.LatLng(parseFloat(this.lat),parseFloat(this.lng));this.iconMarker=null;this.iconOmbre=null;this.ggMarker=null;this.ggCircle=null;this.draw=function(e){this.ggMarker=new google.maps.Marker({position:this.point,map:e});this.ggMarker.setIcon(this.iconMarker);this.ggMarker.setShadow(this.iconOmbre);this.ggMarker.setTitle(this.name)};this.drawTrace=function(e){if(this.trace&&this.trace.length>3){this.ggTrace=new google.maps.KmlLayer(this.trace,{map:e,preserveViewport:false,suppressInfoWindows:true})}};this.drawSalesArea=function(e,t,n,r){if(lastSalesCircle&&n){lastSalesCircle.setMap(null)}if(this.salesRad&&this.salesRad<=0){return}var i=this.salesRad*t;this.ggCircle=new google.maps.Circle({map:e,center:this.point,radius:i,strokeOpacity:1,strokeWeight:1,strokeColor:r,fillColor:r,fillOpacity:.15});lastSalesCircle=this.ggCircle};this.drawUniqueTrace=function(e,t){if(kmlGpsTool){kmlGpsTool.setMap(null)}if(this.trace&&this.trace.length>3){kmlGpsTool=new google.maps.KmlLayer(this.trace,{map:e,preserveViewport:t,suppressInfoWindows:true})}};this.changeSize=function(){if(!this.isCustomSize(this.resizeh,this.resizew)){return}if(this.icon.length>3){obj=new Image;obj.onLoad=imageLoaded(this.ggMarker,this.resizeh,this.resizew,this.icon);obj.src=this.icon}};this.prepareIcon=function(e){if(this.icon.length<1){return}if(this.shadow==1){this.iconOmbre=new google.maps.MarkerImage(e,new google.maps.Size(20,20),new google.maps.Point(0,0),new google.maps.Point(10,10))}if(this.icon.length>3&&!this.isCustomSize(this.resizeh,this.resizew)){this.iconMarker=new google.maps.MarkerImage(this.icon)}else{this.iconMarker=new google.maps.MarkerImage(this.icon,new google.maps.Size(this.resizew,this.resizeh),new google.maps.Point(0,0),new google.maps.Point(this.resizew/2,0),new google.maps.Size(this.resizew,this.resizeh))}};this.isCustomSize=function(e,t){if(e<1){return false}if(t<1){return false}return true}}function clsGfPline(e,t,n){this.idA=e.getAttribute("idA");this.idB=e.getAttribute("idB");this.pointA=new google.maps.LatLng(parseFloat(e.getAttribute("lata")),parseFloat(e.getAttribute("lnga")));this.pointB=new google.maps.LatLng(parseFloat(e.getAttribute("latb")),parseFloat(e.getAttribute("lngb")));this.type=t;this.color=n;this.draw=function(e,t){if(e.length<1){return}var r=0;for(var i in e){oMarker=e[i];if(this.type=="PROFIL"||this.type=="MY_AD"){if(oMarker.type!="MS_CB"&&oMarker.type!="MS_JS"){continue}}else if(oMarker.type!=this.type){continue}if(oMarker.id==this.idA||oMarker.id==this.idB){r+=1;continue}if(r==2){break}}if(r!=2){return null}var s=[this.pointA,this.pointB];return new google.maps.Polyline({path:s,strokeColor:n,strokeOpacity:.9,strokeWeight:t,zIndex:100,clickable:false})}}function clsGfList(e){this.id=e.getAttribute("id");this.name=e.getAttribute("name");this.type=e.getAttribute("type");this.useSide=e.getAttribute("useSide")}function clsGfMap(){this.map=null;this.imageWait=null;this.imageGalWait=null;this.imageGalClose=null;this.imageGalPrev=null;this.imageGalNext=null;this.imageShadow=null;this.iconeUser1=null;this.iconeUser2=null;this.iconeUser3=null;this.iconMyPos=null;this.dirService=null;this.dirDisplay=null;this.geocoder=new google.maps.Geocoder;this.mapOption={};this.centerPointDefault=new google.maps.LatLng(0,0);this.centerPointRadius=new google.maps.LatLng(0,0);this.radCircle=new google.maps.Circle;this.boundaries=new google.maps.LatLngBounds;this.autoComplete=null;this.useMemberPos=false;this.useBrowserPos=false;this.useBoundary=false;this.useNoDoublon=false;this.useRoutePlaner=false;this.exclusiveView=false;this.articleView=false;this.useCluster=false;this.useSelector=false;this.useGallery=false;this.useTabs=false;this.useSideTemplate=false;this.drawRadiusCircle=false;this.markerCluster=null;this.radUnit="km";this.radFact=1e3;this.radValue=0;this.curProfileId=0;this.markersList=new Array;this.plinesList=new Array;this.xmlFile=null;this.xmlFileDyn=null;this.xmlSuffixe=null;this.xmlSuffixeCatDyn="";this.xmlData=new Array;this.curSelectorVal=null;this.colorPlines=new Array;this.clickMarker="click";this.clickMarkerTrack="click";this.clickSales=0;this.trackZoom=true;this.rootJoomla="";this.strokeWeight=3;this.forceZoom=0;this.nameWaitArea="gf_waitZone";this.nameSidelists="gf_sidelists";this.nameSidebar="gf_sidebar";this.nameRadiusSelect="radiusSelect";this.nameAddressInput="addressInput";this.nameSelectorMS="gf_list_selector";this.nameMultiSelectorMS="gf_multi_selector";this.nameStreetView="gf_streetView";this.nameTransport="gf_transport";this.nameItineraire="gf_routepanel";this.nameDebugCont="";this.nameMjrsRefLat="mj_rs_ref_lat";this.nameMjrsRefLng="mj_rs_ref_lng";this.nanameMjrsRefRad="mj_rs_radius_selector";this.idsNoStreetView="No streetview available here.";this.setCenterPointDefault=function(e,t){this.centerPointDefault=new google.maps.LatLng(e,t);centerPointGFmap=this.centerPointDefault};this.setMouse=function(e,t,n,r){if(e==1){this.clickMarker="mouseover"}if(e==2){this.clickMarker="rightclick"}if(e==3){this.clickMarker=3}if(t==1){this.clickSales="click"}if(t==2){this.clickSales="rightclick"}if(t==3){this.clickSales="mouseover"}if(n==1){this.clickMarkerTrack="mouseover"}if(n==2){this.clickMarkerTrack="rightclick"}if(n==3){this.clickMarkerTrack=3}if(r==1){this.trackZoom=false}};this.setRadiusUnit=function(e,t){this.radUnit=e;this.radFact=t};this.setProfileView=function(e){this.exclusiveView=true;this.curProfileId=e};this.setCTRL=function(e,t,n,r){if(e==1){this.mapOption["streetViewControl"]=true}else{this.mapOption["streetViewControl"]=false}if(t==1){this.mapOption["scaleControl"]=true}else{this.mapOption["scaleControl"]=false}if(n==1){this.mapOption["rotateControl"]=true}else{this.mapOption["rotateControl"]=false}if(r==1){this.mapOption["overviewMapControl"]=true}else{this.mapOption["overviewMapControl"]=false}};this.setMMZ=function(e,t){if(t<1||e<1){return}if(t<=e){this.mapOption["minZoom"]=t;this.mapOption["maxZoom"]=e}else{this.mapOption["minZoom"]=e;this.mapOption["maxZoom"]=t}};this.setMTB=function(e,t,n){switch(e){case"HYBRID":this.mapOption["mapTypeId"]=google.maps.MapTypeId.HYBRID;break;case"ROADMAP":this.mapOption["mapTypeId"]=google.maps.MapTypeId.ROADMAP;break;case"SATELLITE":this.mapOption["mapTypeId"]=google.maps.MapTypeId.SATELLITE;break;default:case"TERRAIN":this.mapOption["mapTypeId"]=google.maps.MapTypeId.TERRAIN;break}if(t==0){this.mapOption["mapTypeControl"]=false;return}this.mapOption["mapTypeControl"]=true;this.mapOption["mapTypeControlOptions"]={style:google.maps.MapTypeControlStyle.mTypeBar}};this.setDWZ=function(e,t){if(e==1){this.mapOption["disableDoubleClickZoom"]=false}else{this.mapOption["disableDoubleClickZoom"]=true}if(t==1){this.mapOption["scrollwheel"]=true}else{this.mapOption["scrollwheel"]=false}};this.setSMC=function(e){if(e==0){this.mapOption["zoomControl"]=false;this.mapOption["panControl"]=false;return}this.mapOption["zoomControl"]=true;this.mapOption["panControl"]=true;this.mapOption["zoomControlOptions"]={style:google.maps.ZoomControlStyle.mCtrl}};this.setMZC=function(e){this.mapOption["center"]=this.centerPointDefault;this.mapOption["zoom"]=e};this.setStyle=function(e){this.mapOption["styles"]=e};this.createMap=function(e){this.map=new google.maps.Map(document.getElementById(e),this.mapOption)};this.loadDynCat=function(e,t,n,r){axLoadDyncat(e,t,n,this.rootJoomla,r)};this.autoCompleteStart=function(e,t){if($gf("#"+this.nameAddressInput).length<1){return}var n="";if(t==1){n="establishment"}if(t==2){n="geocode"}if(t==3){n="(cities)"}var r={};if(n.length>1){r.types=[n]}if(e.length>1){r.componentRestrictions={country:e}}var i=document.getElementById(this.nameAddressInput);this.autocomplete=new google.maps.places.Autocomplete(i,r);this.autocomplete.bindTo("bounds",this.map)};this.addNote=function(){copyrightNode=document.createElement("div");copyrightNode.id="gf_note-control";copyrightNode.style.fontSize="10px";copyrightNode.style.fontFamily="Arial, sans-serif";copyrightNode.style.margin="0 2px 2px 0";copyrightNode.style.whiteSpace="nowrap";copyrightNode.index=0;copyrightNode.innerHTML='<a href="http://www.myjoom.com" target="_blank">Map & Markers</a>';this.map.controls[google.maps.ControlPosition.BOTTOM_RIGHT].push(copyrightNode)};this.setUseRoutePlaner=function(){this.useRoutePlaner=true;this.dirService=new google.maps.DirectionsService;this.dirDisplay=new google.maps.DirectionsRenderer;this.dirDisplay.setPanel(document.getElementById(this.nameItineraire));this.dirDisplay.setMap(this.map)};this.setColorpline=function(e){this.colorPlines["users"]=e[0];this.colorPlines["s2"]=e[1];this.colorPlines["mt"]=e[2];this.colorPlines["ev"]=e[3];this.colorPlines["sp"]=e[4];this.colorPlines["am"]=e[5];this.colorPlines["adr"]=e[6];this.colorPlines["je"]=e[7];this.colorPlines["jc"]=e[8];this.colorPlines["gt"]=e[9];this.colorPlines["radius"]=e[10];this.colorPlines["sales"]=e[11]};this.addKmlLayer=function(e){new google.maps.KmlLayer(e,{map:this.map,preserveViewport:true})};this.centerMapOnBrowser=function(){if(this.exclusiveView||this.articleView){return}this.getBrowserPos(false,false)};this.setIconMyPos=function(e){this.iconMyPos=new google.maps.MarkerImage(e,new google.maps.Size(32,32),new google.maps.Point(0,0),new google.maps.Point(16,16))};this.getBrowserPos=function(e,t){map=this.map;var n=this;iconMyPos=this.iconMyPos;defautPos=this.centerPointDefault;if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(r){ptBrowserPos=new google.maps.LatLng(r.coords.latitude,r.coords.longitude);if(t){n.searchLocationsFromPoint(ptBrowserPos)}onsuccessBrowserPos(map,ptBrowserPos,e,iconMyPos)},function(){if(t){n.searchLocationsFromPoint(null)}map.panTo(defautPos);return null})}else if(google.gears){var r=google.gears.factory.create("beta.geolocation");r.getCurrentPosition(function(r){ptBrowserPos=new google.maps.LatLng(r.latitude,r.longitude);if(t){n.searchLocationsFromPoint(ptBrowserPos)}onsuccessBrowserPos(map,ptBrowserPos,e,iconMyPos,t)},function(){if(t){n.searchLocationsFromPoint(null)}map.panTo(defautPos);return null})}else{map.panTo(defautPos);alert("Geocode not possible in this browser.")}};this.manageMapClick=function(e){var t=this;if(e==1){google.maps.event.addListener(this.map,"rightclick",function(e){if(iw){iw.close()}iw=new google.maps.InfoWindow});google.maps.event.addListener(this.map,"click",function(e){if(iw){iw.close()}iw=new google.maps.InfoWindow;t.searchLocationsFromPoint(e.latLng)});return}if(e==2){google.maps.event.addListener(this.map,"rightclick",function(e){if(iw){iw.close()}iw=new google.maps.InfoWindow;t.searchLocationsFromPoint(e.latLng)});google.maps.event.addListener(this.map,"click",function(e){if(iw){iw.close()}iw=new google.maps.InfoWindow});return}google.maps.event.addListener(this.map,"rightclick",function(e){if(iw){iw.close()}iw=new google.maps.InfoWindow});google.maps.event.addListener(this.map,"click",function(e){if(iw){iw.close()}iw=new google.maps.InfoWindow})};this.searchLocationsFromInput=function(){address=$gf("#"+this.nameAddressInput).val();if(address.length<1){this.searchLocationsFromPoint(null);return}var e=this;this.geocoder.geocode({address:address},function(t,n){if(n==google.maps.GeocoderStatus.OK){e.searchLocationsFromPoint(t[0].geometry.location)}else{alert("Geocode was not successful for the following reason : "+n)}})};this.initCircle=function(){if(this.radCircle){this.radCircle.setMap(null)}};this.initRadiusValue=function(){this.radValue=-1;if($gf("#"+this.nameRadiusSelect).length>0){this.radValue=$gf("#"+this.nameRadiusSelect).val()}};this.drawCircle=function(){if(!this.centerPointRadius){return}if(!this.drawRadiusCircle||this.radValue<=0||this.centerPointRadius.lat()==0&&this.centerPointRadius.lng()==0){return}this.radValue*=this.radFact;this.radCircle.setOptions({map:this.map,center:this.centerPointRadius,radius:this.radValue,strokeOpacity:.75,strokeWeight:2,strokeColor:this.colorPlines["radius"],fillColor:this.colorPlines["radius"],fillOpacity:.15})};this.showWaiter=function(){if($gf("#gf_NbrMarkersPre").length>0){this.nameWaitArea="gf_NbrMarkersPre"}$gf("#"+this.nameWaitArea).html(this.imageWait)};this.hideWaiter=function(){$gf("#"+this.nameWaitArea).html("");if($gf("#gf_NbrMarkersPre").length>0){var e=this.markersList.length;$gf("#gf_NbrMarkersPre").html(e)}};this.cleanSide=function(e){if($gf("#"+e).length>0){$gf("#"+e).html("")}};this.setXmlFile=function(e){this.xmlSuffixe="";if(this.centerPointRadius&&this.centerPointRadius.lat()!=0&&this.centerPointRadius.lng()!=0&&$gf("#"+this.nameRadiusSelect).length>0){this.radValue=$gf("#"+this.nameRadiusSelect).val();this.xmlSuffixe="&lat="+this.centerPointRadius.lat()+"&lng="+this.centerPointRadius.lng()+"&radius="+this.radValue;e=this.xmlFileDyn}this.xmlFile=e;if(this.nameDebugCont||$gf("#"+this.nameDebugCont).length>0){$gf("#"+this.nameDebugCont).html("xml file");$gf("#"+this.nameDebugCont).attr("href",this.xmlFile+this.xmlSuffixe+this.xmlSuffixeCatDyn)}};this.initCluster=function(e,t,n,r,i){this.useCluster=true;var s={maxZoom:e,gridSize:t,minimumClusterSize:i};if(n.length>0){s.imagePath=n;s.imageSizes=r}this.markerCluster=new MarkerClusterer(this.map,[],s)};this.setClusters=function(){if(!this.useCluster){return}if(this.markerCluster){this.markerCluster.clearMarkers()}ggMarkers=[];if(this.markersList.length>0){for(var e in this.markersList){if(this.markersList[e].ggMarker!=null){ggMarkers.push(this.markersList[e].ggMarker)}}}this.markerCluster.addMarkers(ggMarkers)};this.initDrawable=function(e){if(e.length<1){return}for(var t=0;t<e.length;t++){if(e[t].ggMarker){e[t].ggMarker.setMap(null);if(e[t].ggCircle){e[t].ggCircle.setMap(null)}}else{e[t].setMap(null)}}e.length=0};this.getMarkersFromXml=function(e){this.xmlData["full"]=e;this.xmlData["markers"]=this.createMarkers(e.documentElement.getElementsByTagName("marker"));this.xmlData["listes"]=this.createLists(e.documentElement.getElementsByTagName("liste"));this.xmlData["plinesUsers"]=this.createPlines(e.documentElement.getElementsByTagName("pline"),"PROFIL",this.colorPlines["users"]);this.xmlData["plinesS2"]=this.createPlines(e.documentElement.getElementsByTagName("pline-sobi2"),"SOBI2",this.colorPlines["s2"]);this.xmlData["plinesMt"]=this.createPlines(e.documentElement.getElementsByTagName("pline-mt"),"MS_MT",this.colorPlines["mt"]);this.xmlData["plinesEv"]=this.createPlines(e.documentElement.getElementsByTagName("pline-jsev"),"MS_JSEV",this.colorPlines["ev"]);this.xmlData["plinesSp"]=this.createPlines(e.documentElement.getElementsByTagName("pline-sobipro"),"MS_SP",this.colorPlines["sp"]);this.xmlData["plinesAm"]=this.createPlines(e.documentElement.getElementsByTagName("pline-am"),"MS_AM",this.colorPlines["am"]);this.xmlData["plinesMyAdr"]=this.createPlines(e.documentElement.getElementsByTagName("pline-myAddresse"),"MY_AD",this.colorPlines["adr"]);this.xmlData["plinesJe"]=this.createPlines(e.documentElement.getElementsByTagName("pline-jev"),"MS_JEV",this.colorPlines["Je"]);this.xmlData["plinesJc"]=this.createPlines(e.documentElement.getElementsByTagName("pline-jc"),"MS_JC",this.colorPlines["Jc"]);this.xmlData["plinesGt"]=this.createPlines(e.documentElement.getElementsByTagName("pline-gt"),"MS_GT",this.colorPlines["gt"])};this.createLists=function(e){var t=new Array;for(var n=0;n<e.length;n++){var r=new clsGfList(e[n]);t.push(r);if(r.useSide==1){this.useSideTemplate=true}}return t};this.createMarkers=function(e){var t=new Array;for(var n=0;n<e.length;n++){var r=new clsGfMarker(e[n]);if(this.useNoDoublon&&n>0){var i=true;if(t.length>0){for(var s in t){if(t[s].type==r.type&&t[s].id==r.id){i=false;break}}}if(!i){continue}}t.push(r)}return t};this.createPlines=function(e,t,n){var r=new Array;for(var i=0;i<e.length;i++){var s=new clsGfPline(e[i],t,n);r.push(s)}return r};this.filterAllowedSelector=function(e){if(!this.useSelector){return true}var t=e.type+"_"+e.liste;for(i=0;i<this.curSelectorVal.length;i++){if(this.curSelectorVal[i]==0){return true}if(this.curSelectorVal[i]==t){return true}}return false};this.drawMarkers=function(){if(this.xmlData["markers"].length<1){return}var e=this;var t=false;for(var n=0;n<this.xmlData["markers"].length;n++){var r=this.xmlData["markers"][n];if(!this.filterAllowedSelector(r)){continue}if(this.useMemberPos&&r.curUser==1){this.map.panTo(r.point);t=true}r.prepareIcon(this.imageShadow);r.draw(this.map);if(this.clickSales==0){r.drawSalesArea(this.map,this.radFact,false,this.colorPlines["sales"])}this.addBounds(r);this.setEditProfilesMarkers(r);this.setMarkerInSide(r);manageMarkerClick(e,r);this.markersList.push(r)}if(this.useMemberPos&&!t){this.map.panTo(this.centerPointDefault)}};this.setMarkerInSide=function(e){if($gf("#"+this.nameSidelists).length>0){this.createSidebarEntry(e,"gf_sidelists")}if($gf("#"+this.nameSidebar).length>0){this.createSidebarEntry(e,"gf_sidebar")}};this.createSidebarEntry=function(e,t){var n="gf_list_"+e.type+"_id_"+e.liste;var r="gf_list_"+e.type+"_id_"+e.liste+"_idMarker_"+e.id;var i=document.createElement("div");var s=e.name;if(e.distance>0){s=s+" ("+e.distance+this.radUnit+" )"}i.innerHTML=s;i.title=s;i.id=r;if(this.clickMarker!=3){i.style.cursor="pointer"}i.style.marginTop="5px";i.style.width="95%";i.onclick=function(){google.maps.event.trigger(e.ggMarker,"click");google.maps.event.trigger(e.ggMarker,"rightclick")};i.setAttribute("onMouseOver",'this.style.fontWeight = "bold"');i.setAttribute("onMouseOut",'this.style.fontWeight = "normal"');if(!document.getElementById(n)){var o=this.getListName(e);var u=document.createElement("div");s="<strong>"+o+"</strong><br /> ";u.id=n;u.innerHTML=s;if(t=="gf_sidelists"){u.setAttribute("style","padding:2px;float:left; width:150px;max-height:150px;overflow:scroll; word-wrap:break-word;border:1px solid grey;")}else if(t=="gf_sidebar"){u.setAttribute("style","padding:2px;float:left; width:150px;word-wrap:break-word;border:1px solid grey;")}u.appendChild(i);document.getElementById(t).appendChild(u)}else{document.getElementById(n).appendChild(i)}if(this.useSideTemplate){axGetSideItem(e.id,e.liste,e.distance,this.rootJoomla,r)}};this.getListName=function(e){for(var t=0;t<this.xmlData["listes"].length;t++){if(this.xmlData["listes"][t].type!=e.type){continue}if(this.xmlData["listes"][t].id!=e.liste){continue}return this.xmlData["listes"][t].name}return"Listing"};this.setEditProfilesMarkers=function(e){if(!this.isCurrentProfileMarker(e)){return}e.ggMarker.setZIndex(google.maps.Marker.MAX_ZINDEX+1);if(e.curUser!=1){return}if(e.type=="MS_CB"){e.ggMarker.setDraggable(true);if(this.setEditProfileMarker(this.iconeUser3,"cb_plug_lat3","cb_plug_lng3",e)){marker_user_3=e.ggMarker}if(this.setEditProfileMarker(this.iconeUser2,"cb_plug_lat2","cb_plug_lng2",e)){marker_user_2=e.ggMarker}if(this.setEditProfileMarker(this.iconeUser1,"cb_plug_lat","cb_plug_lng",e)){marker_user_1=e.ggMarker}}};this.setEditProfileMarker=function(e,t,n,r){if(r.icon!=e){return false}google.maps.event.addListener(r.ggMarker,"dragend",function(e){document.getElementById(t).value=e.latLng.lat();document.getElementById(n).value=e.latLng.lng();this.map.panTo(e.latLng)})};this.isCurrentProfileMarker=function(e){if(this.exclusiveView&&(e.type=="MS_CB"||e.type=="MS_JS")&&e.id==this.curProfileId){return true}return false};this.checkZoomEntry=function(e){if(e.zoomMe<1){return false}if(!this.exclusiveView){this.boundaries=new google.maps.LatLngBounds;this.exclusiveView=true}this.centerPointRadius=e.point;return true};this.addBounds=function(e){if(this.checkZoomEntry(e)){this.boundaries.extend(e.point);return}if(!this.useBoundary&&!this.exclusiveView){return}if(this.isCurrentProfileMarker(e)){this.boundaries.extend(e.point);return}if(this.useBoundary&&!this.exclusiveView){this.boundaries.extend(e.point)}};this.getValueOfSelectors=function(){this.curSelectorVal=new Array;if($gf("#"+this.nameMultiSelectorMS).length>0){this.curSelectorVal=$gf("#"+this.nameMultiSelectorMS).val()||[]}var e=this.curSelectorVal;$gf("#gf_toggeler input:checked").each(function(){e.push(this.name)});this.curSelectorVal=e;if($gf("#"+this.nameSelectorMS).length>0){if($gf("#"+this.nameSelectorMS).val().length>1||$gf("#"+this.nameSelectorMS).val()=="0"){this.curSelectorVal.push($gf("#"+this.nameSelectorMS).val())}}if(this.curSelectorVal.length>0){this.useSelector=true}};this.manageXmlResult=function(e){this.getMarkersFromXml(e);this.drawMarkers();this.drawPlines();this.setClusters();this.hideWaiter();this.drawCircle();this.setBoundary()};this.initFromMjRadiusSearchApp=function(){if($gf("#"+this.nameMjrsRefLat).length<1||$gf("#"+this.nameMjrsRefLng).length<1){return}if(this.centerPointRadius){return}if($gf("#"+this.nameMjrsRefLat).val()==0&&$gf("#"+this.nameMjrsRefLng).val()==0){return}if($gf("#"+this.nanameMjrsRefRad).length>0){this.radValue=$gf("#"+this.nanameMjrsRefRad).val();this.centerPointRadius=new google.maps.LatLng($gf("#"+this.nameMjrsRefLat).val(),$gf("#"+this.nameMjrsRefLng).val())}};this.searchLocationsFromDyn=function(e,t){var n=$gf("#"+e.id).val();this.xmlSuffixeCatDyn="&fc="+n+"&ext="+t;this.radCircle.setRadius(0);this.searchLocationsFromPoint(1);dynCatLastExt=t;dynCatLastId=n};this.searchLocationsFromPoint=function(e){if(e==1){e=null;this.xmlSuffixe=""}else{this.xmlSuffixeCatDyn="";if(dynCatLastExt&&dynCatLastExt.length>1){this.xmlSuffixeCatDyn="&fc="+dynCatLastId+"&ext="+dynCatLastExt}}this.boundaries=new google.maps.LatLngBounds;this.centerPointRadius=e;this.showWaiter();this.cleanSide(this.nameSidelists);this.cleanSide(this.nameSidebar);this.initDrawable(this.markersList);this.initDrawable(this.plinesList);this.initRadiusValue();this.initFromMjRadiusSearchApp();this.initCircle();this.getValueOfSelectors();this.setXmlFile(this.xmlFile);var t=this;downloadUrl(this.xmlFile+this.xmlSuffixe+this.xmlSuffixeCatDyn,function(e){t.manageXmlResult(e)});this.setResizeTrig()};this.setResizeTrig=function(){google.maps.event.trigger(this.map,"resize")};this.setBoundary=function(){if(this.radCircle.getRadius()>0){this.map.fitBounds(this.radCircle.getBounds());centerPointGFmap=this.centerPointRadius;return}if(this.forceZoom>0){this.map.setZoom(this.forceZoom)}if(this.articleView){return}if(!this.useBoundary&&!this.exclusiveView){return}if(this.boundaries.isEmpty()){this.map.panTo(this.centerPointDefault);centerPointGFmap=this.centerPointDefault;return}this.map.fitBounds(this.boundaries);centerPointGFmap=this.boundaries.getCenter();if(this.forceZoom>0){this.map.setZoom(this.forceZoom)}};this.drawPline=function(e){if(e.length<1){return}for(var t in e){if(!e[t].idA||!e[t].idB){continue}var n=e[t].draw(this.markersList,this.strokeWeight);if(!n){continue}n.setMap(this.map);this.addPlineListener(n);this.plinesList.push(n)}};this.addPlineListener=function(e){if(!this.useRoutePlaner){return}e.setOptions({clickable:true});var t=this;google.maps.event.addListener(e,"click",function(n){pts=e.getPath();var r=$gf("#"+t.nameTransport).val();var i={origin:pts.getAt(0),destination:pts.getAt(1),travelMode:google.maps.TravelMode[r]};t.dirService.route(i,function(e,n){if(n==google.maps.DirectionsStatus.OK){t.dirDisplay.setDirections(e)}})});var n={strokeWeight:t.strokeWeight*2,strokeOpacity:1};var r={strokeWeight:t.strokeWeight,strokeOpacity:.9};google.maps.event.addListener(e,"mouseover",function(){e.setOptions(n)});google.maps.event.addListener(e,"mouseout",function(){e.setOptions(r)})};this.drawPlines=function(){this.drawPline(this.xmlData["plinesUsers"]);this.drawPline(this.xmlData["plinesS2"]);this.drawPline(this.xmlData["plinesMt"]);this.drawPline(this.xmlData["plinesEv"]);this.drawPline(this.xmlData["plinesSp"]);this.drawPline(this.xmlData["plinesAm"]);this.drawPline(this.xmlData["plinesGt"]);this.drawPline(this.xmlData["plinesMyAdr"])};this.SLFDYN=function(e,t){this.searchLocationsFromDyn(e,t)};this.SLFI=function(){this.searchLocationsFromInput()};this.SLFP=function(){this.searchLocationsFromPoint(null)};this.LMBTN=function(){this.getBrowserPos(true,false)};this.NMBTN=function(){this.getBrowserPos(false,true)}}function manageMarkerClick(e,t){if(e.clickMarker!=3){google.maps.event.addListener(t.ggMarker,e.clickMarker,function(){iw.setContent(e.imageWait);iw.setOptions({maxWidth:t.width});iw.open(e.map,t.ggMarker);panoramaOptions={position:t.ggMarker.getPosition(),navigationControl:true,enableCloseButton:true,addressControl:true,linksControl:false};manageBubbleLoad(e,t.point);axGetBubble(iw,t.id,t.liste,t.distance,t.ggMarker,e.map,e.rootJoomla)})}if(e.clickSales!=0){google.maps.event.addListener(t.ggMarker,e.clickSales,function(){t.drawSalesArea(e.map,e.radFact,true,e.colorPlines["sales"])})}if(e.clickMarkerTrack!=3){google.maps.event.addListener(t.ggMarker,e.clickMarkerTrack,function(){t.drawUniqueTrace(e.map,e.trackZoom)});if(kmlGpsTool){google.maps.event.addListener(kmlGpsTool,e.clickMarker,function(n){google.maps.event.trigger(t.ggMarker,e.clickMarker)})}}}function manageBubbleLoad(e,t){google.maps.event.addListener(iw,"domready",function(){if(e.useGallery){$gf(function(){$gf("#gallery a").lightBox({imageLoading:e.imageGalWait,imageBtnClose:e.imageGalClose,imageBtnPrev:e.imageGalPrev,imageBtnNext:e.imageGalNext})})}if(e.useTabs){$gf(".tabs").tabs()}$gf("#gfdirws").click(function(){var n=$gf("#"+e.nameTransport).val();var r=$gf("#saddr").val();var i={origin:r,destination:t,travelMode:google.maps.TravelMode[n]};e.dirService.route(i,function(t,n){if(n==google.maps.DirectionsStatus.OK){e.dirDisplay.setDirections(t)}})});$gf("#gflmws").click(function(){var e=new google.maps.Geocoder;if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(t){e.geocode({latLng:new google.maps.LatLng(t.coords.latitude,t.coords.longitude)},function(e,t){if(t==google.maps.GeocoderStatus.OK){$gf("#saddr").val(e[0]["formatted_address"])}})})}else{alert("Your browser is not compatible")}});$gf("#gflm").click(function(){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(t){ptBrowserPos=new google.maps.LatLng(t.coords.latitude,t.coords.longitude);onsuccessBrowserPos(e.map,ptBrowserPos,true,e.iconMyPos);iw.close()})}else if(google.gears){var t=google.gears.factory.create("beta.geolocation");t.getCurrentPosition(function(t){ptBrowserPos=new google.maps.LatLng(t.latitude,t.longitude);onsuccessBrowserPos(e.map,ptBrowserPos,true,e.iconMyPos);iw.close()})}else{alert("Geocode not possible in this browser.")}});$gf("#SV").click(function(){var t=new google.maps.StreetViewService;t.getPanoramaByLocation(panoramaOptions.position,49,function(t,n){if(n==google.maps.StreetViewStatus.OK){var r=new google.maps.StreetViewPanorama(document.getElementById(e.nameStreetView),panoramaOptions);e.map.setStreetView(r)}else{$gf("#"+e.nameStreetView).css("color","red");$gf("#"+e.nameStreetView).css("textAlign","center");$gf("#"+e.nameStreetView).html(e.idsNoStreetView)}})})})}function onsuccessBrowserPos(e,t,n,r){e.panTo(t);if(n){if(locateMarker){locateMarker.setMap(null)}locateMarker=new google.maps.Marker({position:t,icon:r,map:e,draggable:true});e.setZoom(17)}}function imageLoaded(e,t,n,r){iconMarker=new google.maps.MarkerImage(r,null,null,null,new google.maps.Size(n,t));e.setIcon(iconMarker)}function axGetBubble(e,t,n,r,i,s,o){var u;try{if(typeof ActiveXObject!="undefined"){u=new ActiveXObject("Microsoft.XMLHTTP")}else if(window["XMLHttpRequest"]){u=new XMLHttpRequest}}catch(a){}var f=o+"?option=com_geocode_factory&task=axloadbubble&idU="+t+"&idL="+n+"&distance="+r;u.open("GET",f,true);if(document.getElementById("gf_debugmode_bubble")){document.getElementById("gf_debugmode_bubble").innerHTML="bubble link";document.getElementById("gf_debugmode_bubble").href=f}u.onreadystatechange=function(){if(u.readyState==4){var t=u.responseText;e.setContent(t);e.open(s,i)}};u.send(null)}function axLoadDyncat(e,t,n,r,i){var s;try{if(typeof ActiveXObject!="undefined"){s=new ActiveXObject("Microsoft.XMLHTTP")}else if(window["XMLHttpRequest"]){s=new XMLHttpRequest}}catch(o){}var u=r+"?option=com_geocode_factory&task=axLoadDyncat&ext="+e+"&idP="+t+"&mapVar="+i;s.open("GET",u,true);s.onreadystatechange=function(){if(s.readyState==4){var e=s.responseText;if(e.length>0){$gf("#"+n).html(s.responseText);$gf("#"+n).fadeIn("slow")}}};s.send(null)}function axGetSideItem(e,t,n,r,i){var s;try{if(typeof ActiveXObject!="undefined"){s=new ActiveXObject("Microsoft.XMLHTTP")}else if(window["XMLHttpRequest"]){s=new XMLHttpRequest}}catch(o){}var u=r+"?option=com_geocode_factory&task=axloadbubble&type=sidebar&idU="+e+"&idL="+t+"&distance="+n;s.open("GET",u,true);if(document.getElementById("gf_debugmode_side_item")){document.getElementById("gf_debugmode_side_item").innerHTML="Sidelist link";document.getElementById("gf_debugmode_bubble").href=u}s.onreadystatechange=function(){if(s.readyState==4){var e=s.responseText;if(e.length>0){$gf("#"+i).fadeOut("slow");$gf("#"+i).html(s.responseText);$gf("#"+i).fadeIn("slow")}}};s.send(null)}function axSavePos(e,t,n){var r;try{if(typeof ActiveXObject!="undefined"){r=new ActiveXObject("Microsoft.XMLHTTP")}else if(window["XMLHttpRequest"]){r=new XMLHttpRequest}}catch(i){}document.getElementById(n.nameWaitArea).innerHTML=n.imageWait;r.open("GET",n.rootJoomla+"?option=com_geocode_factory&task=axSaveMyPosition&lat="+e+"&lng="+t,true);r.onreadystatechange=function(){if(r.readyState==4){var e=r.responseText;document.getElementById(n.nameWaitArea).innerHTML=e;$gf("#"+n.nameWaitArea).html();n.SLFP()}};r.send(null)}function checkBox(e){var t=document.createElement("DIV");t.className="checkboxContainer";t.title=e.title;var n=document.createElement("SPAN");n.role="checkbox";n.className="checkboxSpan";var r=document.createElement("DIV");r.className="blankDiv";r.id=e.id;bDivs.push(e.id);var i=document.createElement("IMG");i.className="blankImg";i.src="http://maps.gstatic.com/mapfiles/mv/imgs8.png";var s=document.createElement("LABEL");s.className="checkboxLabel";s.innerHTML=e.label;r.appendChild(i);n.appendChild(r);t.appendChild(n);t.appendChild(s);google.maps.event.addDomListener(t,"click",function(){document.getElementById(r.id).style.display=="block"?document.getElementById(r.id).style.display="none":document.getElementById(r.id).style.display="block";document.getElementById(r.id).style.display=="block"?layers[e.id].setMap(e.gmap):layers[e.id].setMap(null)});return t}function optionDiv(e){var t=document.createElement("DIV");t.className="dropDownItemDiv";t.title=e.title;t.id=e.id;t.innerHTML=e.name;google.maps.event.addDomListener(t,"click",function(){for(var e in layers){layers[e].setMap(null)}for(var e in bDivs){if(bDivs[e]&&bDivs[e].length>1&&document.getElementById(bDivs[e])&&document.getElementById(bDivs[e]).style){document.getElementById(bDivs[e]).style.display="none"}}});return t}function separator(){var e=document.createElement("DIV");e.className="separatorDiv";return e}function dropDownOptionsDiv(e){var t=document.createElement("DIV");t.className="dropDownOptionsDiv";t.id=e.id;for(var n=0;n<e.items.length;n++){t.appendChild(e.items[n])}return t}function dropDownControl(e){var t=document.createElement("DIV");t.className="container";var n=document.createElement("DIV");n.className="dropDownControl";n.innerHTML=e.name;n.id=e.name;var r=document.createElement("IMG");r.src="http://maps.gstatic.com/mapfiles/arrow-down.png";r.className="dropDownArrow";n.appendChild(r);t.appendChild(n);t.appendChild(e.dropDown);e.gmap.controls[e.position].push(t);google.maps.event.addDomListener(t,"click",function(){document.getElementById("myddOptsDiv").style.display=="block"?document.getElementById("myddOptsDiv").style.display="none":document.getElementById("myddOptsDiv").style.display="block";setTimeout(function(){document.getElementById("myddOptsDiv").style.display="none"},6e3)})}var panoramaOptions,locateMarker;var iw=new google.maps.InfoWindow;var marker_user_1,marker_user_2,marker_user_3;var centerPointGFmap;var kmlGpsTool,lastSalesCircle;var dynCatLastExt,dynCatLastId;var bDivs=[];var layers={traffic:new google.maps.TrafficLayer,transit:new google.maps.TransitLayer,biking:new google.maps.BicyclingLayer};if(google.maps.weather){layers["cloud"]=new google.maps.weather.CloudLayer;layers["weatherF"]=new google.maps.weather.WeatherLayer({temperatureUnits:google.maps.weather.TemperatureUnit.FAHRENHEIT});layers["weatherC"]=new google.maps.weather.WeatherLayer({temperatureUnits:google.maps.weather.TemperatureUnit.CELSIUS})}